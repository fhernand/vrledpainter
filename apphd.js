var io = require('socket.io-client');

this.host = process.argv[2];
this.strokeActive = false;
this.LEDallblack = true;
this.activeRed = 0;
this.activeGreen = 0;
this.activeBlue = 0;
this.activeLEDSize = 0;


this.sizeZero     = [['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeOne      = [['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','1','3','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeTwo      = [['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','1','3','3','1','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeThree    = [['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','1','1','3','3','1','1','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeFour     = [['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','1','1','1','1','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','0','0','1','1','2','2','1','1','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeFive     = [['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','0','0','0','1','1','2','2','1','1','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeSix      = [['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','3','1','0','0','0'],['0','0','1','2','3','3','3','3','3','3','3','3','2','1','0','0'],['0','0','0','0','1','1','2','2','2','2','1','1','0','0','0','0'],['0','0','0','0','0','0','1','1','1','1','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeSeven    = [['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','1','1','2','3','3','3','3','2','1','1','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','1','2','3','3','3','3','3','3','3','3','2','1','0','0'],['0','1','2','3','3','3','3','3','3','3','3','3','3','2','1','0'],['0','0','0','1','1','2','2','2','2','2','2','1','1','0','0','0'],['0','0','0','0','0','1','1','1','1','1','1','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeEight    = [['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','1','2','2','3','3','3','3','3','3','2','2','1','0','0'],['0','1','2','3','3','3','3','3','3','3','3','3','3','2','1','0'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','3','2'],['0','0','1','1','2','2','2','3','3','2','2','2','1','1','1','0'],['0','0','0','0','1','1','1','1','1','1','1','1','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeNine     = [['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','1','2','2','3','3','2','2','1','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','1','2','3','3','3','3','3','3','3','3','2','1','0','0'],['1','1','2','3','3','3','3','3','3','3','3','3','3','2','1','1'],['2','3','3','3','3','3','3','3','3','3','3','3','3','3','3','2'],['0','1','1','1','2','2','2','3','3','2','2','2','1','1','1','0'],['0','0','0','0','1','1','1','2','2','1','1','1','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeTen      = [['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','0','1','2','2','1','0','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','1','2','3','3','3','3','3','3','3','3','2','1','0','0'],['0','1','2','2','3','3','3','3','3','3','3','3','2','2','1','0'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['0','1','1','2','2','2','3','3','3','3','2','2','2','1','1','0'],['0','0','0','1','1','1','2','2','2','2','1','1','1','0','0','0'],['0','0','0','0','0','0','1','1','1','1','0','0','0','0','0','0'],['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']];
this.sizeEleven   = [['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','0','1','2','3','3','2','1','0','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','1','2','3','3','3','3','3','3','3','3','2','1','0','0'],['0','1','2','2','3','3','3','3','3','3','3','3','2','2','1','0'],['1','2','2','3','3','3','3','3','3','3','3','3','3','2','2','1'],['2','3','3','3','3','3','3','3','3','3','3','3','3','3','3','2'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['1','1','2','2','3','3','3','3','3','3','3','3','2','2','1','1'],['0','1','1','1','2','2','2','3','3','2','2','2','1','1','1','0'],['0','0','0','0','1','1','1','2','2','1','1','1','0','0','0','0'],['0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0']];
this.sizeTwelve   = [['0','0','0','0','0','1','3','3','3','3','1','0','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','0','1','2','3','3','3','3','2','1','0','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','1','2','3','3','3','3','3','3','3','3','2','1','0','0'],['0','0','1','2','3','3','3','3','3','3','3','3','2','1','0','0'],['0','1','2','3','3','3','3','3','3','3','3','3','3','2','1','0'],['0','1','2','3','3','3','3','3','3','3','3','3','3','2','1','0'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['0','1','1','2','3','3','3','3','3','3','3','3','2','1','1','0'],['0','0','0','1','2','2','2','3','3','2','2','2','1','0','0','0'],['0','0','0','0','1','1','1','2','2','1','1','1','0','0','0','0']];
this.sizeThirteen = [['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','0','1','2','3','3','3','3','3','3','2','1','0','0','0'],['0','0','1','2','3','3','3','3','3','3','3','3','2','1','0','0'],['0','0','1','2','3','3','3','3','3','3','3','3','2','1','0','0'],['0','1','2','3','3','3','3','3','3','3','3','3','3','2','1','0'],['0','1','2','3','3','3','3','3','3','3','3','3','3','2','1','0'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['2','3','3','3','3','3','3','3','3','3','3','3','3','3','3','2'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['0','1','2','2','3','3','3','3','3','3','3','3','2','2','1','0'],['0','0','1','1','2','2','3','3','3','3','2','2','1','1','0','0'],['0','0','0','0','1','1','2','3','3','2','1','1','0','0','0','0']];
this.sizeFourteen = [['0','1','2','3','3','3','3','3','3','3','3','3','3','2','1','0'],['0','1','2','3','3','3','3','3','3','3','3','3','3','2','1','0'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['2','3','3','3','3','3','3','3','3','3','3','3','3','3','3','2'],['2','3','3','3','3','3','3','3','3','3','3','3','3','3','3','2'],['2','3','3','3','3','3','3','3','3','3','3','3','3','3','3','2'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['1','2','3','3','3','3','3','3','3','3','3','3','3','3','2','1'],['0','1','2','2','3','3','3','3','3','3','3','3','2','2','1','0'],['0','0','1','1','2','2','3','3','3','3','2','2','1','1','0','0']];
this.sizeFifteen  = [['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3'],['3','3','3','3','3','3','3','3','3','3','3','3','3','3','3','3']];

this.brushSizes = [this.sizeZero,this.sizeOne, this.sizeTwo, this.sizeThree,this.sizeFour, this.sizeFive, this.sizeSix, this.sizeSeven, this.sizeEight, this.sizeNine, this.sizeTen, this.sizeEleven, this.sizeTwelve, this.sizeThirteen, this.sizeFourteen, this.sizeFifteen];

this.activeSize = this.brushSizes[0];

var self = this;

if(io){
	if(!this.host){	
		this.socket = io.connect('http://192.168.0.220:3002');
	} else {	
		this.socket = io.connect(self.host);
	}
	self.joinedRoom = 'theRoom';
	this.socket.on('connect', function (socket) {
		console.log('Connected!');
	});

	this.socket.on('giveOwner', owner => {
		self.socket.owner = owner;
		self.socket.emit('joinRoom', self.joinedRoom);
		console.log('Owner: ', self.socket.owner);
		console.log('Room: ', self.joinedRoom);
	});

	this.socket.on('joinedRoom', function (roomlog){
		console.log("Joined the Room!");
	});

	this.socket.on('newStroke', event => {
		if(event.stroke.owner === self.socket.owner) return;
		//console.log("New stroke");
		this.activeRed = Math.round(event.stroke.color[0] * 255);
		this.activeGreen = Math.round(event.stroke.color[1] * 255);
		this.activeBlue = Math.round(event.stroke.color[2] * 255);
		self.strokeActive = true;
	  });
	

	  this.socket.on('endStroke', () => {
		//console.log("End stroke");
		self.activeSize = self.brushSizes[0];  
		self.strokeActive = false;
	  });

	/*
	  this.socket.on('newPoints', event => {
		if(!event[0] || event[0].stroke.owner === self.socket.owner) return;
		//console.log("New points");
	  });
	  */
	
	  this.socket.on('newLEDSize', event => {
		  
		//console.log("LEDSize changed: ", event.ledsize);
		  if (event.ledsize != self.activeLEDSize){
		      self.activeLEDSize = event.ledsize;
		      self.activeSize = self.brushSizes[event.ledsize];	 
		  }
	  });	

}

var UnicornHatHD = require('unicornhat-hd');
var unicornHatHD = new UnicornHatHD('/dev/spidev0.0'); 
unicornHatHD.setBrightness(1.0);

var NUM_ROWS = 16;
var NUM_COLS = 16;

// ---- trap the SIGINT and reset before exit
process.on('SIGINT', function () {
  unicornHatHD.clear();
  unicornHatHD.show(false,false);
  process.nextTick(function () { process.exit(0); });
});


// ---- animation-loop
setInterval(function () {
	if (self.strokeActive && self.activeSize != self.brushSizes[0]){
		var lowModifier = 4;
		var mediumModifier = 2;
		for (var x = 0; x < NUM_ROWS; x++) {
		   for (var y = 0; y < NUM_COLS; y++) {
			switch (self.activeSize[x][y]){
				case '0':
					unicornHatHD.setPixel(y,x,0,0,0);
					break;
				case '1':
					unicornHatHD.setPixel(y,x,Math.floor(self.activeRed / lowModifier), Math.floor(self.activeGreen / lowModifier), Math.floor(self.activeBlue / lowModifier));
					break;					
				case '2':
					unicornHatHD.setPixel(y,x,Math.floor(self.activeRed / mediumModifier), Math.floor(self.activeGreen / mediumModifier), Math.floor(self.activeBlue / mediumModifier));
					break;					
				case '3':
					unicornHatHD.setPixel(y,x,Math.floor(self.activeRed), Math.floor(self.activeGreen), Math.floor(self.activeBlue));
					break;
				default:
					//console.log("No size data available");
					//pixelData[i] = colorwheel((offset + i) % 256);
			}
		   }
		}
		unicornHatHD.show(false,false);
		if(self.LEDallblack){
			self.LEDallblack = false;
		}
	} else {
		clearLEDs();
	}
}, 1000 / 30);

function clearLEDs(){
	if (!self.LEDallblack){
		unicornHatHD.clear();
		unicornHatHD.show(false,false);
		self.LEDallblack = true;
	}	
}
